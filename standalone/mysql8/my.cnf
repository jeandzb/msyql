[mysqld]
# --- 基础配置 ---
user            = mysql
port            = 3306
character-set-server = utf8mb4
collation-server     = utf8mb4_0900_ai_ci
skip-name-resolve
authentication_policy = mysql_native_password

# --- 内存与连接 (针对业务连接池问题优化) ---
innodb_buffer_pool_size = 3G
innodb_buffer_pool_instances = 4
max_connections = 600
wait_timeout = 600
interactive_timeout = 600
thread_stack = 256K
sort_buffer_size = 512K

# --- I/O 优化 ---
innodb_flush_method = O_DIRECT
innodb_io_capacity = 2000
innodb_flush_neighbors = 0

# --- 日志持久化 (修复 8.0.28 报错) ---
# 8.0.28 不支持 innodb_redo_log_capacity，必须用下面这两个旧参数
innodb_log_file_size = 512M
innodb_log_files_in_group = 2
innodb_log_buffer_size = 32M
innodb_flush_log_at_trx_commit = 2

# --- 其他 ---
binlog_expire_logs_seconds = 604800
slow_query_log = 1
long_query_time = 2